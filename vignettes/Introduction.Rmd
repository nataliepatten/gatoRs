---
title: "Introduction to gatoRs"
output:
  html_document:
    df_print: paged
---

gatoRs (Geographic and Taxonomic Occurrence R-Based Scrubbing) provides users with tools to streamline the downloading and processing biodiversity data.

## Data Downloading 

### Identifying Synonyms
Historically, many names may have been used to refer to your taxa of interest. For example, specimen representing <i>Galax urceolata</i> (Diapensiaceae) can be found under the scientific  name <i>Galax aphylla</i>, despite the latter being invalidated over 50 years ago ([see more here](https://en.wikipedia.org/wiki/Galax)). Since synonyms are common, we designed gatoRs retrieve biodiversity records based on a list of names, however the user must supply the synonym list.   

There are many databases available to compile synonym lists for plant species including:

  - [World Flora Online - WFO Plant List](https://wfoplantlist.org/plant-list)
  - [TROPICOS](https://www.tropicos.org/)
  - [World Checklist of Vascular Plants](https://powo.science.kew.org/)
  - [USDA PLANTS Database](https://plants.usda.gov/home)
  - [International Plant Names Index](https://www.ipni.org/)
  - [World Plants](https://www.worldplants.de/world-plants-complete-list/complete-plant-list)
  
 Many R packages have been developed to access these databases including: 
 
  - [taxize](https://docs.ropensci.org/taxize/)
  - [RTNRS](https://github.com/EnquistLab/RTNRS)
  - [WorldFlora](https://cran.r-project.org/web/packages/WorldFlora/index.html)
  - [Taxonstand](https://cran.r-project.org/web/packages/Taxonstand/index.html)
  - [U.Taxonstand](https://github.com/ecoinfor/U.Taxonstand)
     

### Download with gatoRs
With `gators_download()` you can obtain biodiversity records for your species of interest from both GBIF and iDigBio. This function is innovative in how it searches iDigBio. Unlike `spocc::occ()`, we do not query the iDigBio API using the scientific name field, as this will only return exact matches. Instead, we designed a "pseudo-fuzzy match" to search all fields for partial matches to the supplied scientific names. Additionally, the columns returned have been handpicked to aid in processing records for investigations of species distributions (see more `gators_download()`). 

After you identify synonyms, create a list of all possible names for your species of interest with the first name in the list as the accepted name (ex. `c("Galax urceolata", "Galax aphylla")`). Note, the first name in your list will be used to identify the GBIF species code when `gbif_match = "code"`. 

Example:
```
gators_download(synonyms_list = c("Asclepias curtissii", "Asclepias aceratoides",
                                  "Asclepias arenicola", "Oxypteryx arenicola", 
                                  "Oxypteryx curtissii"), 
                newFileName = "base_folder/other_folder/my_file.csv", # Location to save file - must end in .csv
                gbif_match = "fuzzy",
                idigbio_filter = TRUE)
```

Optional parameters include `gbif_match` and `idigbio_filter`. `gbif_match` allows you to search by fuzzy matching records to the scientific name (default, `gbif_match = "fuzzy"`) or to search for the associated species key using GBIFâ€™s backbone taxonomy system (`gbif_match = "code"`).

If set to TRUE (default, recommended), `idigbio_filter` fuzzy matches taxonomic columns to provided taxon names. This filters the data set for relevant data.

The function also generates scientificName, genus, specificEpithet, and infraspecificEpithet columns based on available data and parsing and then fixes incorrect capitalization of species names to give the data a cleaner look.

## Data Processing    
### Identify Records Missing Information 
#### Redacted Records
To find data that needs to be manually received by an institution via a permit (or removed from the data set), use `needed_records()`. Use your downloaded data from the previous step as input. After receiving the data from herbaria, manually enter into the original data set.

Example: 
```
redacted_info <- needed_records(occurrence_records)
```

#### Records to Georeference
To find data lacking coordinates but containing locality information, use `need_to_georeference()`. Use your downloaded data from the first step as input. You should georeference these records and manually enter the information into the data set.

Example: 
```
to_georeference <- need_to_georeference(occurrence_records)
```

### Occurrence Data Cleaning  
#### Resolve Taxon Names
To find data containing scientific names corresponding to your desired species, use `filter_select_name()`. Use your downloaded data from the first step as input, as well as a synonyms list, the accepted name, and the filter option (exact, fuzzy, or interactive).

Example:
```
occurrence_records <- filter_select_name(occurrence_records, 
                                        synonyms_list = c("Asclepias curtissii", "Asclepias aceratoides",
                                                          "Asclepias arenicola", "Oxypteryx arenicola", 
                                                          "Oxypteryx curtissii"), 
                                        filter = "interactive", 
                                        accepted_name = "Asclepias curtissii")
```
#### Clean locality  

#### Find and remove flagged points
To find records that may have problematic coordinates, use `find_flagged()`. This will let you interactively manually remove points deemed improper by viewing the points on a graph. Use your downloaded data from the previous step as input.

Example: 
```
occurrence_records <- find_flagged(occurrence_records)
```
#### Final cleaning
To remove duplicate points and reduce the clustering of points, use our `final_clean()` function. This function also offers an interactive method to look at (and remove, if desired) types of basis of record.

Example: 
```
occurrence_records <- final_clean(occurrence_records)
```
